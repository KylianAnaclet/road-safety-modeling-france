---
title: "Projet_math_appli"
output: html_document
date: "2025-12-08"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{data =}
```

## Including Plots

You can also embed plots, for example:

```         
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.

```{r}
df = read.csv("/user/3/kebairii/Desktop/Projet_maths_appli/equipe_19/data/ONISR-2021.csv")
head(df)
```

```{r}
#Score de sévérité (test 1 4 12)
df$score_de_severite = (1*df$nb_blesse) +(4*df$nb_hospitalise) + (12*df$nb_tue)

#test d'un modèle qui semble corect
#R² = 0.134
modele = lm(score_de_severite~lum + col + agg +catr + vma, data = df )
summary(modele)
```

```{r}
test_cor <- cor.test(df$vma, df$score_de_severite)
test_cor
modele_simple <- lm(score_de_severite ~ vma, data = df)
summary(modele_simple)
plot(df$vma, df$score_de_severite, 
     main = "Régression : Sévérité en fonction de la VMA",
     xlab = "Vitesse Max Autorisée (km/h)",
     ylab = "Score de Sévérité",
     pch = 19, col = "blue") 
# On ajoute la droite de régression 
abline(modele_simple, col = "red", lwd = 2)
#vérifier les hyp du modèle de régression linéR
#qqline,qqnorm()
modele_complet <- lm(score_de_severite ~ vma + factor(lum) + factor(col), data = df)
residus <- resid(modele_complet)

# A. Normalité (QQ-Plot)
qqnorm(residus, main = "QQ-Plot des Résidus (Normalité)")
qqline(residus, col = "red", lwd = 2)



# ==============================================================================
# INTERPRETATION DES GRAPHIQUES (Pour le rapport)
# ==============================================================================

# 1. ANALYSE DE LA LINEARITE (abline)
# Observation : La droite de regression rouge presente une pente positive.
# Conclusion : Cela valide la coherence physique du modele. L'augmentation de la
# VMA entraine bien une augmentation globale de la severite moyenne.
# La dispersion importante des points (R^2 ~ 0.02) indique que la vitesse n'est
# pas le seul facteur explicatif et qu'on peut surement trouver mieux
#Je pense qu'on peut adapter ce code à un autre cor.test() pour que cela soit plus cohérent



# 2. ANALYSE DE LA NORMALITE DES RESIDUS (qqnorm / qqline)
#Obs : on constate qu'au début et au milieu les points noirs suivent la droite rouge mais très vite ils s'éloignent de cette ligne. Cette déviation s'explique par le fait qu'il y a des évènement extremes que le modèle n'arrive pas à prédire correctement


```

```{r}
modele_complexe <- lm(score_de_severite ~ vma + col + agg*catr + plan, data =df)
summary(modele_avance)

```
